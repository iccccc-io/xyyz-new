<!--pages/login/login.wxml-->
<view class="login-container">
  <!-- 顶部装饰 -->
  <view class="header-decoration">
    <view class="deco-circle deco-1"></view>
    <view class="deco-circle deco-2"></view>
  </view>

  <!-- Logo 和标题 - 新中式极简风格 -->
  <view class="header-section">
    <view class="logo-area">
      <view class="logo-title-row">
        <text class="logo-text">湘韵遗珍</text>
        <view class="logo-seal">湘</view>
      </view>
      <text class="logo-subtitle">探寻湖南非遗之美</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-section" wx:if="{{pageState === 'loading'}}">
    <van-loading size="40px" color="#8B2E2A" vertical>
      正在检查登录状态...
    </van-loading>
  </view>

  <!-- 自动登录成功状态 -->
  <view class="done-section" wx:elif="{{pageState === 'done'}}">
    <van-icon name="checked" size="60" color="#8B2E2A" />
    <text class="done-text">登录成功，正在跳转...</text>
  </view>

  <!-- 注册表单（仅新用户显示） -->
  <view class="form-section" wx:elif="{{pageState === 'form'}}">
    <!-- 新用户提示 -->
    <view class="new-user-tip">
      <text>首次使用，请完善您的信息</text>
    </view>

    <!-- 头像选择区 -->
    <view class="form-item avatar-item">
      <button 
        class="avatar-button" 
        open-type="chooseAvatar" 
        bindchooseavatar="onChooseAvatar"
      >
        <image 
          class="avatar-image {{avatarSelected ? 'selected' : ''}}" 
          src="{{avatarUrl}}" 
          mode="aspectFill"
        />
        <view class="avatar-edit-icon">
          <van-icon name="photograph" size="16" color="#fff" />
        </view>
      </button>
      <text class="avatar-tip">点击选择头像</text>
    </view>

    <!-- 昵称输入区 -->
    <view class="form-item nickname-item">
      <view class="input-wrap">
        <van-icon name="user-o" size="20" color="#8B2E2A" custom-class="input-icon" />
        <input 
          class="nickname-input"
          type="nickname"
          placeholder="请输入昵称"
          placeholder-class="input-placeholder"
          value="{{nickname}}"
          bindinput="onNicknameInput"
          bindblur="onNicknameBlur"
        />
      </view>
    </view>

    <!-- 提交按钮 -->
    <view class="form-item submit-item">
      <button 
        class="submit-button {{submitting ? 'disabled' : ''}}"
        bindtap="onSubmit"
        disabled="{{submitting}}"
      >
        <text>{{submitting ? '注册中...' : '立即注册'}}</text>
      </button>
    </view>

    <!-- 跳过登录 -->
    <view class="skip-wrap" bindtap="onSkip">
      <text class="skip-text">暂不登录，随便逛逛</text>
    </view>
  </view>

  <!-- 底部提示 -->
  <view class="footer-section" wx:if="{{pageState === 'form'}}">
    <text class="footer-tip">登录即表示同意</text>
    <text class="footer-link">《用户协议》</text>
    <text class="footer-tip">和</text>
    <text class="footer-link">《隐私政策》</text>
  </view>
</view>

